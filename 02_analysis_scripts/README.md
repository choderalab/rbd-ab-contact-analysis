## Analysis
Below are exmaples of how to use analysis scripts to analyse the dataset for F@H data in [DOI link]. It is recommened to run each of these scripts in separate directories.

**Note**: these scripts were developed as part of a time sensive project, as a result they are not memory efficient.

### Contact analysis
`analyze_antibody_rbd_contacts.py` can be used to generate a series of `.pkl` files containing an N x M x No. frames array of distances between heavy atoms at the RBD:Ab interface.

For example, analysing the F@H `17341` project (S2H97:Ab):

```python
python analyze_antibody_rbd_contacts.py -mutant WT -pdb_file system.pdb -traj_path path/to/traj/ -fah_project_code 17341 -chain_info_file chain_info_S2H97_RBD.yaml -run_number 0 -discard_time 100
```
* `system.pdb` should contain no solvent.
* `path/to/traj/` should be a path to munged F@H data (Data available at: [S2H97](https://covid.molssi.org//simulations/#foldinghome-simulations-of-the-sars-cov-2-spike-rbd-bound-to-monoclonal-antibody-s2h97), [S309](https://covid.molssi.org//simulations/#foldinghome-simulations-of-the-sars-cov-2-spike-rbd-bound-to-monoclonal-antibody-s309)).

### Interaction count
The `.pkl` files generated from `analyze_antibody_rbd_contacts.py` can then be used with the `count_ab_rbd_interactions.py` script. Since the Ab typically contains two chains, the antibody chain number needs to specified.

```python
python count_ab_rbd_interactions.py -path_name path/to/contacts/ -ab_chain_key 1 -metadata_file PROJ17341_WT_selection_metadata.pkl -project_number 17341 -mutant WT
```

* `path/to/contacts/` should be a path containing the `.pkl` files generated by `analyze_antibody_rbd_contacts.py`.
* The `-metadata` flag should point to a `.pkl` metadata file generated by `analyze_antibody_rbd_contacts.py`.

### Plotting
Running `count_ab_rbd_interactions.py` produces one `.pkl` file per antibody chain (e.g. count_chain1.pkl and count_chain2.pkl). These can then be used in the `make_hmaps.py` script.

```python
python make_hmaps.py -data count_chain1.pkl count_chain2.pkl -save_path path/to/save/plots -ab_name S2H97 -custom_residues_file s2h97_ab_custom_residues.yaml
```